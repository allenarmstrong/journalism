
		/*
 * Copyright (C) 2007 Trivantis Corporation
 */

	
var theApp=new webtoraAppl();var is=theApp.is;var trivDebug=0;var trivAddMsgFunc=null;var trivDebugWnd='';var trivSaveMsg='';var trivWeb20Popups=false;function trivLogMsg(A,B){if ((!trivDebug)||(B&&!(trivDebug&B))) return;var C=findTrivLogMsg(window,true);if (C.trivDebug){if (A){if (C.trivSaveMsg.length){C.trivSaveMsg+='<br />';};C.trivSaveMsg+=A;};if (!C.trivDebugWnd&&C.opening==1){setTimeout("trivLogMsg()",200);}else if (!C.trivDebugWnd||C.trivDebugWnd.closed||!C.trivDebugWnd.location){C.opening=1;C.trivDebugWnd=C.open('trivantisdebug.html','TrivantisDebug','width=400,height=400,scrollbars=0,resizable=1,menubar=0,toolbar=0,location=0,status=0');setTimeout("trivLogMsg()",200);}else{if (C.trivAddMsgFunc){A=C.trivSaveMsg;C.trivSaveMsg='';C.trivAddMsgFunc(A);}}}};function findTrivLogMsg(A,B) {if(B&&A.opener&&(!A.parent.SCOPreviewWnd)&&(!A.opener.rbnPubl)&&A.opener.trivLogMsg) {return findTrivLogMsg(A.opener,false);}while(A) {if(A.parent&&A.parent!=A&&(!A.parent.SCOPreviewWnd)&&(!A.parent.rbnPubl)&&A.parent.trivLogMsg) {A=A.parent;}else {break;}};return A;};var winW=screen.width;var winH=screen.height;function findWH() {winW=(is.ns)?window.innerWidth-16:document.body.offsetWidth-20;winH=(is.ns)?window.innerHeight:document.body.offsetHeight;};function ObjLayer(A,B,C) {var D=this;if (!ObjLayer.bInit&&!C) {InitObjLayers();};D.frame=C||self;if (is.ie10orless){D.ele=D.event=D.frame.document.all[A];D.styObj=D.frame.document.all[A].style;D.doc=document;D.x=D.ele.offsetLeft;D.y=D.ele.offsetTop;D.w=D.ele.offsetWidth;D.h=D.ele.offsetHeight;}else{D.ele=D.event=document.getElementById(A);D.styObj=D.ele.style;D.doc=document;D.x=D.ele.offsetLeft;D.y=D.ele.offsetTop;D.w=D.ele.offsetWidth;D.h=D.ele.offsetHeight;};D.id=A;D.unique=1;D.pref=B;D.hasMoved=false;D.newX=null;D.newY=null;};ObjLayer.arrPref=[];ObjLayer.arrRef=[];ObjLayer.arrRef.i=0;ObjLayer.bInit=false;var p=ObjLayer.prototype;p.actionGoTo=ObjLayerActionGoTo;p.actionGoToNewWindow=ObjLayerActionGoToNewWindow;function ObjLayerActionGoTo(A,B,C,D) {var E=null;var F=D!=null?D:true;if(B) {if(B=="opener") E=parent.opener;else if(B=="_top") E=eval("parent");else if(B=="NewWindow") E=open(A,'NewWindow');else {var G=eval("parent");var H=0;while(H<G.length) {if(G.frames[H].name==B) {E=G.frames[H];break;};H++;};if(C) {H=0;G=E;while(H<G.length) {if(G.frames[H].name==C) {E=G.frames[H];break;};H++;}};try{if(!E.closed&&E.trivExitPage) {E.trivExitPage(A,F);return;}}catch(e){}}};if(!E) E=window;try{if(!E.closed) E.location.href=A;}catch(e){}};function ObjLayerActionGoToNewWindow(A,B,C) {var D;B=B?B.replace(/\s+/g,"_"):B;if ((C.indexOf('left=')==-1)&&(C.indexOf('top=')==-1)) C+=GetNewWindXAndYPos(C);D=window.open(A,B,C,false);if(D) D.focus();return D;};function preload(A) {setTimeout(function(){if (!document.images) return;var B=[];for (var i=0;i<A.length;i++) {B[i]=new Image();B[i].src=A[i];}},100);};p.moveTo=function(x,y) {var A=this;if (x!==null) {A.x=x;if(A.styObj) {A.styObj.left=A.x;}};if (y!==null) {A.y=y;if(A.styObj) {A.styObj.top=A.y;}}};p.moveBy=function(x,y) {this.moveTo(this.x+x,this.y+y);};p.clipInit=function(t,r,b,l){if (arguments.length==4) {this.clipTo(t,r,b,l);}else {this.clipTo(0,this.ele.offsetWidth,this.ele.offsetHeight,0);}};p.clipTo=function(t,r,b,l) {if(this.styObj) this.styObj.clip="rect("+t+"px "+r+"px "+b+"px "+l+"px)";};p.show=function() {if(this.styObj) this.styObj.visibility="inherit";};p.hide=function() {if(this.styObj) this.styObj.visibility="hidden";};p.actionPlay=function(){};p.actionStop=function(){};p.actionShow=function(){this.show();};p.actionHide=function(){this.hide();};p.actionLaunch=function(){};function ObjLayerActionExit(){if(this.frameElement&&this.frameElement.id&&this.frameElement.id.indexOf('DLG_content')==0) trivCloseDialog();else{window.open('','_self','');window.close();setTimeout(function(){if (window&&window.top) window.top.close();},250);}};p.actionExit=ObjLayerActionExit;p.actionChangeContents=function(){};p.actionTogglePlay=function(){};p.isVisible=function() {if(!this.styObj||this.styObj.visibility=="hide"||this.styObj.visibility=="hidden") {return false;}else {return true;}};p.write=function(A) {this.event.innerHTML=A;};function InitObjLayers(A) {var B=document;var C=null;if (!ObjLayer.bInit) {ObjLayer.bInit=true;};if (is.ns) {if (A) {C=eval('document.'+A+'.document');}else {A='';if(is.ns5) {B.layers=B.getElementsByTagName("*");C=B;}else {C=B;}};for (var i=0;i<C.layers.length;i++) {var D;if(is.ns5) {if(C.layers[i]) {D=C.layers[i].tagName;}else {D=null;}}else {D=C.layers[i].name;};if(D) {ObjLayer.arrPref[D]=A;if (!is.ns5&&C.layers[i].doc.layers.length>0) {ObjLayer.arrRef[ObjLayer.arrRef.length]=(A==='')?C.layers[i].name:A+'.document.'+C.layers[i].name;}}};if (ObjLayer.arrRef.i<ObjLayer.arrRef.length) {InitObjLayers(ObjLayer.arrRef[ObjLayer.arrRef.i++]);}};return true;};function buildCSS(A,B,C,D,E,F,G,H,I) {var J=arguments.length;var K=(B!==null&&C!==null)?'#'+A+' {position:absolute; left:'+B+'px; top:'+C+'px;':'#'+A+' {position:relative;';if (J>=4&&D!==null) {K+=' width:'+D+'px;';};if (J>=5&&E!==null) {K+=' height:'+E+'px;';if (J<9||I.indexOf('clip')==-1) {K+=' clip:rect(0px '+D+'px '+E+'px 0px);';}};if (J>=6&&F!==null) {K+=' visibility:'+(F?'inherit':'hidden')+';';};if (J>=7&&G!==null) {K+=' z-index:'+G+';';};if (J>=8&&H!==null) {K+=' background:'+H+';';};if (J==9&&I!==null) {K+=' '+I;};K+='}\n';return K;};function writeStyleSheets(A) {var B='<style type="text/css">\n';B+=A;B+='</style>';document.write(B);};function getHTTP(A,B,C,D){var E;if(B=='GET') {if(C) {A+='?'+C;C=null;}};var F='Issuing '+B+' to '+A;if(C) F+=' for ['+C+']';trivLogMsg(F);var G=0;try {if (window.XMLHttpRequest) {E=new XMLHttpRequest();E.open(B,A,false);E.onreadystatechange=null;if(B=='POST') {E.setRequestHeader('Content-Type','application/x-www-form-urlencoded;charset=UTF-8');};E.send(C);G=1;}}catch(e){if(typeof(D)!="undefined"&&D!=null&&e.code==D) G=1;};if (!G&&window.ActiveXObject) {E=new ActiveXObject("Microsoft.XMLHTTP");if (E) {E.open(B,A,false);if(B=='POST') {E.setRequestHeader('Content-Type','application/x-www-form-urlencoded;charset=UTF-8');};E.send(C);}};trivLogMsg('ReturnCode = '+E.status+' Received Data ['+E.responseText+']');if (E.status===0) trivLogMsg('Status 0 is returned if posting to a different domain and trying to receive a response (cross-domain is not allowed) or the course is not running on a web server.');return E;};function GenRand(A,B){return Math.floor(Math.random()*(B-A+1)+A);};function GetNewWindXAndYPos(A) {var B="\\s*([^,\\s]*)\\s*";var C=new RegExp("width="+B,"i");C.test(A);var D=RegExp.$1;C=new RegExp("height="+B,"i");C.test(A);var E=RegExp.$1;var F=(screen.width-D)/2;var G=(screen.height-E)/2;return ',left='+F+',top='+G;};function Encode(s){if (s==n) return '';return encodeURIComponent(s);};function Decode(s){if (s==n) return '';return decodeURIComponent(s);};function UniUnescape(s){if (s==n) return '';return unescape(String(s).replace(/%5Cu/g,'%u'));};function wndPagePublished(){var A=this;A.rtData1=-1;A.rtData2=-1;var B=document.getElementById("wndPage");A.div=B;A.processed=false;var C=document.body;if (B){C.onmousedown=function(e) { return A.mouseDown(e);};C.onmousemove=function(e) { return A.mouseMove(e);};C.onmouseup=function(e) { return A.mouseUp(e);};C.ondblclick=function(e) { return A.mouseDblClk(e);};C.oncontextmenu=function(e) { return A.contextMenu(e);};C.onclick=function(e) { return A.mouseClick(e);};document.onkeydown=function(e) { return A.keyDown(e);};};A.currMouseObj=0;A.arDelayAct=[];A.arTransInWnds=[];A.arTransOutWnds=[];};p=wndPagePublished.prototype;p.processMouseAct=function(e,A){if(!e) e=window.event;var B=(e.target?e.target:e.srcElement?e.srcElement:null);var C=this.getDivObj(B);var D=t;switch (A){case 1:if (C) D=C.mouseDown(e);else if(typeof(pageClick)=='function') D=pageClick(e);break;case 2:this.setCurrMouseObj(C);if (C) D=C.mouseMove(e);break;case 3:if (C) D=C.mouseUp(e);break;case 4:if (C&&C.mouseDblClk) D=C.mouseDblClk(e);break;case 5:if (C&&C.contextMenu) D=C.contextMenu(e);else if(typeof(pageRClick)=='function'){pageRClick(e);return cancelEvent(e);};break;};return D;};p.mouseDown=function(e){if(!e) e=window.event;if(e.which==1||(!e.which&&(e.button==0||e.button==1))) return this.processMouseAct(e,1);return t;};p.mouseMove=function(e){return this.processMouseAct(e,2);};p.mouseUp=function(e){var A=this.processMouseAct(e,3);this.processed=true;return A;};p.mouseDblClk=function(e){if(!e) e=window.event;if(e.which==1||(!e.which&&e.button==1)||theApp.is.ie10orLess) return this.processMouseAct(e,4);return t;};p.mouseClick=function(e){if(!e) e=window.event;var A=this;if(!A.processed){A.mouseDown(e);A.mouseUp(e);};A.processed=false;};p.contextMenu=function(e){return this.processMouseAct(e,5);};p.keyDown=function(e){if(typeof(pageKey)=='function'){if (!e) e=window.event;var A=e.keyCode;var B=((e.altKey?1:0)|(e.ctrlKey?2:0)|(e.shiftKey?4:0));return pageKey(A,B);};return t;};p.setCurrMouseObj=function(A) {var B=this.currMouseObj;if(B!=A){if (theApp.is.mobile==f){if (B&&B.mouseExit) B.mouseExit();this.currMouseObj=A;if (A&&A.mouseEnter) A.mouseEnter();}}};p.getDivObj=function(A){var B=0;while(!B&&A){B=(A.popM?A.popM:(A.tObj?A.tObj:0));A=A.parentNode;};return B;};p.issueShowActions=function(A){trivIssueShowActs(A);};p.doAction=function(A){if (typeof A!='undefined') A();};p.findWndByObj=function (o){return o.wnd;};p.fixA=function(){if (theApp.is.ie10orLess) trivArExec(document.getElementsByTagName("A"),function(o){o.style.cursor='hand';try {if (!o.style.color) o.style.color=o.parentNode.style.color;} catch(e){}});var A=getURLParams();if (A['title']) document.title=A['title'];};p.fixEmbeddedTables=function(){if (theApp.is.ie10orLess) trivArExec(document.getElementsByTagName("TABLE"),function(o){if (o.parentNode&&o.parentNode.getAttribute('name')=='dCon2'){trivArExec(o.getElementsByTagName("TD"),function(A){try{var w=A.style.width;A.style.width=null;A.style.width=w;}catch (e) {}});}});};p.alignEmbObjs=function(){var A=document.getElementsByTagName("img");trivArExec(A,function(F){try {if (F.id.indexOf("ee")!==0) return;var B={ x:F.offsetLeft,y:F.offsetTop };var C=F.parentNode;while (!(C.getAttribute('name')&&C.getAttribute('name').indexOf('dCon2')===0)){if (C.tagName&&(C.tagName.toLowerCase()=="td"||C.tagName.toLowerCase()=="tbody"||C.tagName.toLowerCase()=="table")){B.x+=C.offsetLeft;B.y+=C.offsetTop;};C=C.parentNode;};var D=F.id.substring(2);var E=document.getElementById('tobj'+D);E.style.top=B.y+"px";E.style.left=B.x+"px";} catch(e) {if (window.console) window.console.error(e);}});};function cwObjPub(){this.arChld=[];};p=cwObjPub.prototype;p.getTrans=function(A){var B=this.transData;return (B?(A?B[0]:B[1]):0);};p.getTransSpeed=function(A){var B=this.transData;return (B?(A?B[2]:B[3]):0);};p.getTransDelay=function(A){var B=this.transData;return (B?(A?B[4]:B[5]):0);};p.getTransEffect=function(A){var B=this.transData;return (B?(A?B[8]:B[9]):0);};p.getXPos=function(){return this.rect.x;};p.getYPos=function(){return this.rect.y;};trivGoToPage=null;trivCompleteCnt=1;hasProcessedExitActions=false;trivWndFeedback=null;trivWndImmFeedback=null;currFeedbackIdx=0;trivPageExited=false;trivNumQuestions=0;trivProcessTest=0;trivActFBCnt=0;function trivCloseDialog(){var A;var B=false;if(this.frameElement&&this.frameElement.parentNode){for(i=0;i<this.frameElement.parentNode.childNodes.length;i++){if(this.frameElement.parentNode.childNodes[i].id=='DLG_hiddenClose'){A=this.frameElement.parentNode.childNodes[i];break;}};if(A&&A.onclick){A.onclick();B=true;}};return B;};function trivOnFocus() {if (window.trivOnFocusDisabled) return;if(trivWndFeedback) {try{if(!trivWndFeedback.closed){trivWndFeedback.close();trivWndFeedback=null;}}catch(e){};setTimeout('checkLeavePage()',100);}};function trivCenter() {try{var A=trivPage.div.style;var B=window.innerWidth;if (!B) B=document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth;if (parseInt(A.width)>=B){A.left='0px';A.marginLeft='';}else{A.left='50%';A.marginLeft='-'+(Math.round((parseInt(A.width)/2)))+'px';}}catch(e){if(window.console) console.log(e);}};function checkLeavePage(){if(trivPageExited) return;if(trivActFBCnt==0){currFeedbackIdx++;if(currFeedbackIdx>(trivNumQuestions-1)) {if(trivProcessTest&&(bInProcessTest||trivGoToPage==null)) {bInProcessTest=false;processTest(1);}else if (trivExitPage.transOutDone&&trivExitPage.transOutDone()==false){setTimeout('checkLeavePage()',100);}else trivLeavePage();return;}else if(!checkQuestions(true)) return;};setTimeout('checkLeavePage()',100);};function trivLeavePage(){trivCompleteCnt--;if(trivCompleteCnt<=0){if (trivLeavePage.trivSaveVars) trivLeavePage.trivSaveVars();hasProcessedExitActions=false;eval(trivGoToPage);trivGoToPage=null;trivPageExited=true;setTimeout(function(){trivPageExited=false;hasProcessedExitActions=false;},750);}};function getUserInfo(A,B,C,D,E){if(B==null||B==''){for (var i=0;i<E.length;i++){var F=window["Var"+E[i].timerVarName];F.set("pause:0");};var G=new jsDlgPromptBox('u1',A,C,'',function(e,H,I){ if(H==0)B=I;else B=null;userInfoEntered(A,C,D,B,A,E);});G.create();return;};persistUserName(A,B);};function userInfoEntered(A,B,C,D,A,F){if(D==undefined||D==''){for (var i=0;i<F.length;i++){var G=window["Var"+F[i].timerVarName];G.set("pause:0");};if (D==undefined) cancelTest();else{var H=new jsTrivDlgMsgBox('u0',A,C,0,function(e,I){ getUserInfo(A,D,B,C,F);});H.create();};return;};persistUserName(A,D);trivArExec(F,function(J){if (J.autoStart) window["Var"+J.timerVarName].set((parseInt((new Date().getTime()+500)/1000)*1000));});};function persistUserName(A,B){saveVariable('TrivantisUserName',B,null,A);var C=getTitleMgrHandle();if (C) C.setUserInfo(B,null);};function trivExitPage(A,B){if(A.indexOf("ObjLayerAction")>=0||A.indexOf(".action")>=0||A.indexOf("history.back()")>=0) trivGoToPage=A;else trivGoToPage='ObjLayerActionGoTo("'+A+'")';if(!hasProcessedExitActions){findWH();if (trivExitPage.trivExitPageChkExit) if (trivExitPage.trivExitPageChkExit(B)===0) return;hasProcessedExitActions=true;if (trivExitPage.trivExitPageItemExits) trivExitPage.trivExitPageItemExits();setTimeout('checkLeavePage()',100);}};function trivAlert(A,B,C,D){if(trivWeb20Popups&&window.jsTrivDlgMsgBox){var E=new jsTrivDlgMsgBox(A,B,C,f,D);E.create();}else alert(C);};function trivCloseWnd(){if(this.frameElement&&this.frameElement.id&&this.frameElement.id.indexOf('DLG_content')==0) trivCloseDialog();else window.close();};function trivMailTo(A){window.top.document.location.href='mailto:'+A;};
